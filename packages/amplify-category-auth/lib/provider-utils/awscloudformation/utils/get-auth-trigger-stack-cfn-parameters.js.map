{"version":3,"file":"get-auth-trigger-stack-cfn-parameters.js","sourceRoot":"","sources":["../../../../src/provider-utils/awscloudformation/utils/get-auth-trigger-stack-cfn-parameters.ts"],"names":[],"mappings":";;;AACA,8EAAyE;AACzE,mDAAqD;AAM9C,MAAM,gCAAgC,GAAG,KAAK,EAAE,OAAmB,EAAE,gBAAwB,EAAgC,EAAE;IACpI,MAAM,yBAAyB,GAAG,OAAO,gBAAgB,EAAE,CAAC;IAC5D,MAAM,0BAA0B,GAAwB;QACtD,UAAU,EAAE;YACV,YAAY,EAAE,CAAC,yBAAyB,EAAE,oBAAoB,CAAC;SAChE;QACD,WAAW,EAAE;YACX,YAAY,EAAE,CAAC,yBAAyB,EAAE,qBAAqB,CAAC;SACjE;KACF,CAAC;IACF,MAAM,SAAS,GAAG,IAAI,iCAAc,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAAC;IAChE,IAAI,SAAS,CAAC,kBAAkB,EAAE,EAAE;QAClC,MAAM,EAAE,aAAa,EAAE,GAAG,SAAS,CAAC,kBAAkB,EAAE,CAAC;QACzD,MAAM,YAAY,GAAG,IAAA,kCAAkB,EAAC,aAAa,CAAC,CAAC;QACvD,IAAI,CAAC,aAAa,CAAC,cAAc,IAAI,YAAY,EAAE;YACjD,0BAA0B,CAAC,UAAU,GAAG;gBACtC,YAAY,EAAE,CAAC,yBAAyB,EAAE,wBAAwB,CAAC;aACpE,CAAC;SACH;KACF;IACD,OAAO,0BAA0B,CAAC;AACpC,CAAC,CAAC;AArBW,QAAA,gCAAgC,oCAqB3C","sourcesContent":["import { $TSContext } from '@aws-amplify/amplify-cli-core';\nimport { AuthInputState } from '../auth-inputs-manager/auth-input-state';\nimport { configureSmsOption } from './configure-sms';\n\n/**\n *\n * returns CFN parameters required by root stack from Auth trigger Stack\n */\nexport const getAuthTriggerStackCfnParameters = async (context: $TSContext, authResourceName: string): Promise<AuthTriggerCfnTypes> => {\n  const authRootStackResourceName = `auth${authResourceName}`;\n  const authTriggerRootStackParams: AuthTriggerCfnTypes = {\n    userpoolId: {\n      'Fn::GetAtt': [authRootStackResourceName, 'Outputs.UserPoolId'],\n    },\n    userpoolArn: {\n      'Fn::GetAtt': [authRootStackResourceName, 'Outputs.UserPoolArn'],\n    },\n  };\n  const authState = new AuthInputState(context, authResourceName);\n  if (authState.cliInputFileExists()) {\n    const { cognitoConfig } = authState.getCLIInputPayload();\n    const configureSMS = configureSmsOption(cognitoConfig);\n    if (!cognitoConfig.useEnabledMfas || configureSMS) {\n      authTriggerRootStackParams.snsRoleArn = {\n        'Fn::GetAtt': [authRootStackResourceName, 'Outputs.CreatedSNSRole'],\n      };\n    }\n  }\n  return authTriggerRootStackParams;\n};\n\n/**\n * type returned to Root Stack cfn parameter for auth trigger\n */\nexport type AuthTriggerCfnTypes = {\n  userpoolId: Record<'Fn::GetAtt', string[]>;\n  userpoolArn: Record<'Fn::GetAtt', string[]>;\n  snsRoleArn?: Record<'Fn::GetAtt', string[]>;\n};\n"]}