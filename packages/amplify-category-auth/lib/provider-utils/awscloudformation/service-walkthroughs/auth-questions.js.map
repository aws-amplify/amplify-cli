{"version":3,"file":"auth-questions.js","sourceRoot":"","sources":["../../../../src/provider-utils/awscloudformation/service-walkthroughs/auth-questions.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport inquirer from 'inquirer';\nimport chalk from 'chalk';\nimport _, { uniq, pullAll } from 'lodash';\nimport path from 'path';\n// const { parseTriggerSelections } = require('../utils/trigger-flow-auth-helper');\nimport { Sort } from 'enquirer';\nimport { AuthContext } from '../../../context';\nimport { extractApplePrivateKey } from '../utils/extract-apple-private-key';\nimport { authProviders, attributeProviderMap, capabilities } from '../assets/string-maps';\n\nconst category = 'auth';\n\n/**\n * The enquirer module has a type declaration file that does not match its actual api.\n * The package is no longer maintained, so a fix to the file cannot be expected.\n * This declaration overrides the types exported from the package.\n */\ndeclare module 'enquirer' {\n  export class Sort {\n    constructor(sortParameters: any);\n    run(): Promise<string[]>;\n  }\n}\n\n/* eslint-disable no-param-reassign */\nexport const serviceWalkthrough = async (\n  context: AuthContext,\n  defaultValuesFilename: any,\n  stringMapsFilename: any,\n  serviceMetadata: any,\n  coreAnswers: { [key: string]: any } = {},\n): Promise<Record<string, unknown>> => {\n  const { inputs } = serviceMetadata;\n  const { amplify } = context;\n  const { parseInputs } = await import(`${__dirname}/../question-factories/core-questions.js`);\n  const projectType = amplify.getProjectConfig().frontend;\n  const defaultValuesSrc = `${__dirname}/../assets/${defaultValuesFilename}`;\n  const { getAllDefaults } = await import(defaultValuesSrc);\n  let userPoolGroupList = context.amplify.getUserPoolGroupList(context);\n  let adminQueryGroup;\n\n  handleUpdates(context, coreAnswers);\n\n  // QUESTION LOOP\n  let j = 0;\n  while (j < inputs.length) {\n    const questionObj = inputs[j];\n\n    // CREATE QUESTION OBJECT\n    const question = await parseInputs(questionObj, amplify, defaultValuesFilename, stringMapsFilename, coreAnswers, context);\n\n    // ASK QUESTION\n    const answer: any = await inquirer.prompt(question);\n\n    /* eslint-disable spellcheck/spell-checker */\n    if ('signinwithapplePrivateKeyUserPool' in answer) {\n      answer.signinwithapplePrivateKeyUserPool = extractApplePrivateKey(answer.signinwithapplePrivateKeyUserPool);\n    }\n    /* eslint-enable spellcheck/spell-checker */\n    if (answer.userPoolGroups === true) {\n      userPoolGroupList = await updateUserPoolGroups(context);\n    }\n\n    if (answer.adminQueries === true) {\n      adminQueryGroup = await updateAdminQuery(context, userPoolGroupList);\n    }\n\n    if (answer.triggers && answer.triggers !== '{}') {\n      const tempTriggers = context.updatingAuth && context.updatingAuth.triggers ? JSON.parse(context.updatingAuth.triggers as string) : {};\n      const selectionMetadata = capabilities;\n\n      /* eslint-disable no-loop-func */\n      selectionMetadata.forEach((selection: { [key: string]: any }) => {\n        Object.keys(selection.triggers).forEach((t) => {\n          if (!tempTriggers[t] && answer.triggers.includes(selection.value)) {\n            tempTriggers[t] = selection.triggers[t];\n          } else if (tempTriggers[t] && answer.triggers.includes(selection.value)) {\n            tempTriggers[t] = uniq(tempTriggers[t].concat(selection.triggers[t]));\n          } else if (tempTriggers[t] && !answer.triggers.includes(selection.value)) {\n            const tempForDiff = Object.assign([], tempTriggers[t]);\n            const remainder = pullAll(tempForDiff, selection.triggers[t]);\n            if (remainder && remainder.length > 0) {\n              tempTriggers[t] = remainder;\n            } else {\n              delete tempTriggers[t];\n            }\n          }\n        });\n      });\n      answer.triggers = tempTriggers;\n    }\n\n    // LEARN MORE BLOCK\n    if (new RegExp(/learn/i).test(answer[questionObj.key]) && questionObj.learnMore) {\n      const helpText = `\\n${questionObj.learnMore.replace(new RegExp('[\\\\n]', 'g'), '\\n\\n')}\\n\\n`;\n      questionObj.prefix = chalk.green(helpText);\n      // ITERATOR BLOCK\n    } else if (\n      /*\n        if the input has an 'iterator' value, we generate a loop which uses the iterator value as a\n        key to find the array of values it should splice into.\n      */\n      questionObj.iterator &&\n      answer[questionObj.key] &&\n      answer[questionObj.key].length > 0\n    ) {\n      const replacementArray = context.updatingAuth?.[questionObj.iterator as keyof AuthContext['updatingAuth']] ?? ([] as unknown[]);\n      for (let t = 0; t < answer[questionObj.key].length; t += 1) {\n        questionObj.validation = questionObj.iteratorValidation;\n        const newValue = await inquirer.prompt({\n          name: 'updated',\n          message: `Update ${answer[questionObj.key][t]}`,\n          validate: amplify.inputValidation(questionObj),\n        });\n        replacementArray.splice(replacementArray.indexOf(answer[questionObj.key][t]), 1, newValue.updated);\n      }\n      j += 1;\n      // ADD-ANOTHER BLOCK\n    } else if (questionObj.addAnotherLoop && Object.keys(answer).length > 0) {\n      /*\n        if the input has an 'addAnotherLoop' value, we first make sure that the answer\n        will be recorded as an array index, and if it is already an array we push the new value.\n        We then ask the user if they want to add another url.  If not, we increment our counter (j)\n        so that the next question is appears in the prompt.  If the counter isn't incremented,\n        the same question is reapated.\n      */\n      if (!coreAnswers[questionObj.key]) {\n        answer[questionObj.key] = [answer[questionObj.key]];\n        coreAnswers = { ...coreAnswers, ...answer };\n      } else {\n        coreAnswers[questionObj.key].push(answer[questionObj.key]);\n      }\n      const addAnother = await inquirer.prompt({\n        name: 'repeater',\n        type: 'confirm',\n        default: false,\n        message: `Do you want to add another ${questionObj.addAnotherLoop}`,\n      });\n      if (!addAnother.repeater) {\n        j += 1;\n      }\n    } else if (questionObj.key === 'updateFlow') {\n      /*\n        if the user selects a default or fully manual config option during an update,\n        we set the useDefault value so that the appropriate questions are displayed\n      */\n      if (answer.updateFlow === 'updateUserPoolGroups') {\n        userPoolGroupList = await updateUserPoolGroups(context);\n      } else if (answer.updateFlow === 'updateAdminQueries') {\n        adminQueryGroup = await updateAdminQuery(context, userPoolGroupList);\n      } else if (['manual', 'defaultSocial', 'default'].includes(answer.updateFlow)) {\n        answer.useDefault = answer.updateFlow;\n        if (answer.useDefault === 'defaultSocial') {\n          coreAnswers.hostedUI = true;\n        }\n\n        if (answer.useDefault === 'default') {\n          coreAnswers.hostedUI = false;\n        }\n        delete answer.updateFlow;\n      }\n      coreAnswers = { ...coreAnswers, ...answer };\n      j += 1;\n    } else if (!context.updatingAuth && answer.useDefault && ['default', 'defaultSocial'].includes(answer.useDefault)) {\n      // if the user selects defaultSocial, we set hostedUI to true to avoid re-asking this question\n      coreAnswers = { ...coreAnswers, ...answer };\n      coreAnswers.authSelections = 'identityPoolAndUserPool';\n      if (coreAnswers.useDefault === 'defaultSocial') {\n        coreAnswers.hostedUI = true;\n      }\n      j += 1;\n    } else {\n      coreAnswers = { ...coreAnswers, ...answer };\n      j += 1;\n    }\n  }\n\n  // POST-QUESTION LOOP PARSING\n\n  // if user selects user pool only, ensure that we clean id pool options\n  if (coreAnswers.authSelections === 'userPoolOnly' && context.updatingAuth) {\n    context.print.warning(\n      `Warning! Your existing IdentityPool: ${context.updatingAuth.identityPoolName} will be deleted upon the next “amplify push”!`,\n    );\n    delete context.updatingAuth.identityPoolName;\n    delete context.updatingAuth.allowUnauthenticatedIdentities;\n    delete context.updatingAuth.thirdPartyAuth;\n    delete context.updatingAuth.authProviders;\n    delete context.updatingAuth.facebookAppId;\n    delete context.updatingAuth.googleClientId;\n    delete context.updatingAuth.googleIos;\n    delete context.updatingAuth.googleAndroid;\n    delete context.updatingAuth.amazonAppId;\n    delete context.updatingAuth.appleAppId;\n  }\n\n  // formatting data for identity pool providers\n  if (coreAnswers.thirdPartyAuth) {\n    identityPoolProviders(coreAnswers, projectType);\n  }\n\n  const isPullOrEnvCommand = context.input.command === 'pull' || context.input.command === 'env';\n  if (coreAnswers.authSelections !== 'identityPoolOnly' && context.input.command !== 'init' && !isPullOrEnvCommand) {\n    if (coreAnswers.useDefault === 'manual') {\n      coreAnswers.triggers = await lambdaFlow(context, coreAnswers.triggers);\n    }\n  }\n\n  // formatting data for user pool providers / hosted UI\n  if (coreAnswers.authProvidersUserPool) {\n    coreAnswers = Object.assign(coreAnswers, userPoolProviders(coreAnswers.authProvidersUserPool, coreAnswers, context.updatingAuth));\n  }\n\n  // formatting oAuthMetaData\n  structureOAuthMetadata(coreAnswers, context, getAllDefaults, amplify);\n\n  if (coreAnswers.usernameAttributes && !Array.isArray(coreAnswers.usernameAttributes)) {\n    if (coreAnswers.usernameAttributes === 'username') {\n      delete coreAnswers.usernameAttributes;\n    } else {\n      coreAnswers.usernameAttributes = coreAnswers.usernameAttributes.split();\n    }\n  }\n\n  return {\n    ...coreAnswers,\n    userPoolGroupList,\n    adminQueryGroup,\n    serviceName: 'Cognito',\n  };\n};\n/* eslint-enable no-param-reassign */\n\nconst updateUserPoolGroups = async (context: any): Promise<string[]> => {\n  let userPoolGroupList: string[] = [];\n  let existingGroups;\n\n  const userGroupParamsPath = path.join(\n    context.amplify.pathManager.getBackendDirPath(),\n    'auth',\n    'userPoolGroups',\n    'user-pool-group-precedence.json',\n  );\n\n  try {\n    existingGroups = context.amplify.readJsonFile(userGroupParamsPath);\n    userPoolGroupList = existingGroups.map((e: any) => e.groupName);\n  } catch (e) {\n    existingGroups = null;\n  }\n\n  if (existingGroups) {\n    // eslint-disable-next-line\n    const deletionChoices = existingGroups.map((e: any) => {\n      return { name: e.groupName, value: e.groupName };\n    });\n\n    const deletionAnswer = await inquirer.prompt([\n      {\n        name: 'groups2BeDeleted',\n        type: 'checkbox',\n        message: 'Select any user pool groups you want to delete:',\n        choices: deletionChoices,\n      },\n    ]);\n\n    userPoolGroupList = userPoolGroupList.filter((i: any) => !deletionAnswer.groups2BeDeleted.includes(i));\n  }\n\n  let answer;\n\n  /* Must be sure to ask this question in the event that it is the\n  first time in the user pool group flow, or it is an update but\n  the user has deleted all existing groups. If they want to delete\n  all groups they should just delete the resource */\n  if (userPoolGroupList.length < 1) {\n    answer = await inquirer.prompt([\n      {\n        name: 'userPoolGroupName',\n        type: 'input',\n        message: 'Provide a name for your user pool group:',\n        validate: context.amplify.inputValidation({\n          validation: {\n            operator: 'regex',\n            value: '^[a-zA-Z0-9]+$',\n            onErrorMsg: 'Resource name should be alphanumeric',\n          },\n          required: true,\n        }),\n      },\n    ]);\n    userPoolGroupList.push(answer.userPoolGroupName);\n  }\n\n  let addAnother = await inquirer.prompt({\n    name: 'repeater',\n    type: 'confirm',\n    default: false,\n    message: 'Do you want to add another User Pool Group',\n  });\n\n  while (addAnother.repeater === true) {\n    answer = await inquirer.prompt([\n      {\n        name: 'userPoolGroupName',\n        type: 'input',\n        message: 'Provide a name for your user pool group:',\n        validate: context.amplify.inputValidation({\n          validation: {\n            operator: 'regex',\n            value: '^[a-zA-Z0-9]+$',\n            onErrorMsg: 'Resource name should be alphanumeric',\n          },\n          required: true,\n        }),\n      },\n    ]);\n\n    userPoolGroupList.push(answer.userPoolGroupName);\n\n    addAnother = await inquirer.prompt({\n      name: 'repeater',\n      type: 'confirm',\n      default: false,\n      message: 'Do you want to add another User Pool Group',\n    });\n  }\n\n  // Get distinct list\n  const distinctSet = new Set(userPoolGroupList);\n  userPoolGroupList = Array.from(distinctSet);\n\n  // Sort the Array to get precedence\n  let sortedUserPoolGroupList: string[] = [];\n\n  if (userPoolGroupList && userPoolGroupList.length > 0) {\n    const sortPrompt = new Sort({\n      name: 'sortUserPools',\n      hint: `(Use ${chalk.green.bold('<shift>+<right/left>')} to change the order)`,\n      message: 'Sort the user pool groups in order of preference',\n      choices: userPoolGroupList,\n      shiftLeft(...args: any[]) {\n        return this.shiftUp(...args);\n      },\n      shiftRight(...args: any[]) {\n        return this.shiftDown(...args);\n      },\n    });\n\n    sortedUserPoolGroupList = await sortPrompt.run();\n  }\n  return sortedUserPoolGroupList;\n};\n\nconst updateAdminQuery = async (context: AuthContext, userPoolGroupList: any[]): Promise<string> => {\n  let adminGroup;\n  // Clone user pool group list\n  const userPoolGroupListClone = userPoolGroupList.slice(0);\n  if (await context.amplify.confirmPrompt('Do you want to restrict access to the admin queries API to a specific Group')) {\n    userPoolGroupListClone.push('Enter a custom group');\n\n    const adminGroupAnswer = await inquirer.prompt([\n      {\n        name: 'adminGroup',\n        type: 'list',\n        message: 'Select the group to restrict access with:',\n        choices: userPoolGroupListClone,\n      },\n    ]);\n\n    if (adminGroupAnswer.adminGroup === 'Enter a custom group') {\n      const temp = await inquirer.prompt([\n        {\n          name: 'userPoolGroupName',\n          type: 'input',\n          message: 'Provide a group name:',\n          validate: context.amplify.inputValidation({\n            validation: {\n              operator: 'regex',\n              value: '^[a-zA-Z0-9]+$',\n              onErrorMsg: 'Resource name should be alphanumeric',\n            },\n            required: true,\n          }),\n        },\n      ]);\n      adminGroup = temp.userPoolGroupName;\n    } else {\n      ({ adminGroup } = adminGroupAnswer);\n    }\n  }\n  return adminGroup;\n};\n\n/*\n  Create key/value pairs of third party auth providers,\n  where key = name accepted by updateIdentityPool API call and value = id entered by user\n*/\n/* eslint-disable no-param-reassign */\nexport const identityPoolProviders = (coreAnswers: any, projectType: any): any => {\n  coreAnswers.selectedParties = {};\n  authProviders.forEach((provider: any) => {\n    // don't send google value in cf if native project, since we need to make an openid provider\n    if (projectType === 'javascript' || provider.answerHashKey !== 'googleClientId') {\n      if (coreAnswers[provider.answerHashKey]) {\n        coreAnswers.selectedParties[provider.value] = coreAnswers[provider.answerHashKey];\n      }\n      /*\n        certain third party providers require multiple values,\n        which Cognito requires to be a concatenated string -\n        so here we build the string using 'concatKeys' defined in the thirdPartyMap\n      */\n      if (coreAnswers[provider.answerHashKey] && provider.concatKeys) {\n        provider.concatKeys.forEach((i: any) => {\n          coreAnswers.selectedParties[provider.value] = coreAnswers.selectedParties[provider.value].concat(';', coreAnswers[i]);\n        });\n      }\n    }\n  });\n  if (projectType !== 'javascript' && coreAnswers.authProviders.includes('accounts.google.com')) {\n    coreAnswers.audiences = [coreAnswers.googleClientId];\n    if (projectType === 'ios') {\n      coreAnswers.audiences.push(coreAnswers.googleIos);\n    } else if (projectType === 'android') {\n      coreAnswers.audiences.push(coreAnswers.googleAndroid);\n    }\n  }\n  coreAnswers.selectedParties = JSON.stringify(coreAnswers.selectedParties);\n};\n\n/*\n  Format hosted UI providers data per lambda spec\n  hostedUIProviderMeta is saved in parameters.json.\n  hostedUIProviderCreds is saved in deployment-secrets.\n*/\nexport const userPoolProviders = (oAuthProviders: any, coreAnswers: any, prevAnswers?: any): any => {\n  if (coreAnswers.useDefault === 'default') {\n    return null;\n  }\n  const answers = Object.assign(prevAnswers || {}, coreAnswers);\n  const attributesForMapping = answers.requiredAttributes\n    ? JSON.parse(JSON.stringify(answers.requiredAttributes)).concat('username')\n    : ['email', 'username'];\n  const res: { [key: string]: any } = {};\n  if (answers.hostedUI) {\n    res.hostedUIProviderMeta = JSON.stringify(\n      oAuthProviders.map((providerName: any) => {\n        const lowerCaseEl = providerName.toLowerCase();\n        const delimiter = providerName === 'Facebook' ? ',' : ' ';\n        const scopes: any[] = [];\n        const maps: any = {};\n        attributesForMapping.forEach((attribute: keyof typeof attributeProviderMap) => {\n          const attributeKey: any = attributeProviderMap[attribute];\n          if (attributeKey && attributeKey[`${lowerCaseEl}`] && attributeKey[`${lowerCaseEl}`].scope) {\n            if (scopes.indexOf(attributeKey[`${lowerCaseEl}`].scope) === -1) {\n              scopes.push(attributeKey[`${lowerCaseEl}`].scope);\n            }\n          }\n          if (providerName === 'Google' && !scopes.includes('openid')) {\n            scopes.unshift('openid');\n          }\n          if (attributeKey && attributeKey[`${lowerCaseEl}`] && attributeKey[`${lowerCaseEl}`].attr) {\n            maps[attribute] = attributeKey[`${lowerCaseEl}`].attr;\n          }\n        });\n        return {\n          ProviderName: providerName,\n          authorize_scopes: scopes.join(delimiter),\n          AttributeMapping: maps,\n        };\n      }),\n    );\n    res.hostedUIProviderCreds = JSON.stringify(\n      oAuthProviders.map((el: any) => {\n        const lowerCaseEl = el.toLowerCase();\n        if (el === 'SignInWithApple') {\n          return {\n            ProviderName: el,\n            client_id: coreAnswers[`${lowerCaseEl}ClientIdUserPool`],\n            team_id: coreAnswers[`${lowerCaseEl}TeamIdUserPool`],\n            key_id: coreAnswers[`${lowerCaseEl}KeyIdUserPool`],\n            private_key: coreAnswers[`${lowerCaseEl}PrivateKeyUserPool`],\n          };\n        }\n        return {\n          ProviderName: el,\n          client_id: coreAnswers[`${lowerCaseEl}AppIdUserPool`],\n          client_secret: coreAnswers[`${lowerCaseEl}AppSecretUserPool`],\n        };\n      }),\n    );\n  }\n  return res;\n};\n\n/*\n  Format hosted UI oAuth data per lambda spec\n*/\nexport const structureOAuthMetadata = (coreAnswers: any, context: AuthContext, defaults: any, amplify: any): any => {\n  if (coreAnswers.useDefault === 'default' && context.updatingAuth) {\n    delete context.updatingAuth.oAuthMetadata;\n    return null;\n  }\n  const answers = { ...context.updatingAuth, ...coreAnswers };\n  let { AllowedOAuthFlows, AllowedOAuthScopes, CallbackURLs, LogoutURLs } = answers;\n  if (CallbackURLs && coreAnswers.newCallbackURLs) {\n    CallbackURLs = CallbackURLs.concat(coreAnswers.newCallbackURLs);\n  } else if (coreAnswers.newCallbackURLs) {\n    CallbackURLs = coreAnswers.newCallbackURLs;\n  }\n  if (LogoutURLs && coreAnswers.newLogoutURLs) {\n    LogoutURLs = LogoutURLs.concat(coreAnswers.newLogoutURLs);\n  } else if (coreAnswers.newLogoutURLs) {\n    LogoutURLs = coreAnswers.newLogoutURLs;\n  }\n\n  if (CallbackURLs && LogoutURLs) {\n    if (!answers.AllowedOAuthScopes) {\n      AllowedOAuthScopes = defaults(amplify.getProjectDetails(amplify)).AllowedOAuthScopes;\n    }\n    if (!answers.AllowedOAuthFlows) {\n      AllowedOAuthFlows = defaults(amplify.getProjectDetails(amplify)).AllowedOAuthFlows;\n    } else {\n      AllowedOAuthFlows = Array.isArray(AllowedOAuthFlows) ? AllowedOAuthFlows : [AllowedOAuthFlows];\n    }\n  }\n\n  if (AllowedOAuthFlows && AllowedOAuthScopes && CallbackURLs && LogoutURLs) {\n    coreAnswers.oAuthMetadata = JSON.stringify({\n      AllowedOAuthFlows,\n      AllowedOAuthScopes,\n      CallbackURLs,\n      LogoutURLs,\n    });\n  }\n\n  return coreAnswers;\n};\n\n/*\n  Deserialize oAuthData for CLI update flow\n*/\nconst parseOAuthMetaData = (previousAnswers: any): void => {\n  if (previousAnswers && previousAnswers.oAuthMetadata) {\n    previousAnswers = Object.assign(previousAnswers, JSON.parse(previousAnswers.oAuthMetadata));\n    delete previousAnswers.oAuthMetadata;\n  }\n};\n\n/**\n * Deserialize oAuthCredentials for CLI update flow\n */\nexport const parseOAuthCreds = (providers: string[], metadata: any, envCreds: any): Record<string, unknown> => {\n  const providerKeys: Record<string, unknown> = {};\n  try {\n    const parsedMetaData = JSON.parse(metadata);\n    const parsedCreds = JSON.parse(envCreds);\n    providers\n      .map((providerName) => providerName.toLowerCase())\n      .forEach((providerName: string) => {\n        const provider: { authorize_scopes: string } | undefined = parsedMetaData.find(\n          (currentProvider: any) => currentProvider.ProviderName === providerName,\n        );\n        const creds = parsedCreds.find((currentProvider: any) => currentProvider.ProviderName === providerName);\n        if (providerName === 'SignInWithApple') {\n          providerKeys[`${providerName}ClientIdUserPool`] = creds?.client_id;\n          providerKeys[`${providerName}TeamIdUserPool`] = creds?.team_id;\n          providerKeys[`${providerName}KeyIdUserPool`] = creds?.key_id;\n          providerKeys[`${providerName}PrivateKeyUserPool`] = creds?.private_key;\n        } else {\n          providerKeys[`${providerName}AppIdUserPool`] = creds?.client_id;\n          providerKeys[`${providerName}AppSecretUserPool`] = creds?.client_secret;\n        }\n        providerKeys[`${providerName}AuthorizeScopes`] = provider?.authorize_scopes?.split?.(',');\n      });\n  } catch (e) {\n    return {};\n  }\n  return providerKeys;\n};\n\n/*\n  Handle updates\n*/\n/* eslint-disable no-param-reassign */\nconst handleUpdates = (context: AuthContext, coreAnswers: any): any => {\n  if (context.updatingAuth && context.updatingAuth.triggers) {\n    coreAnswers.triggers = {};\n    coreAnswers.triggers = context.updatingAuth.triggers;\n  }\n\n  if (context.updatingAuth && context.updatingAuth.oAuthMetadata) {\n    parseOAuthMetaData(context.updatingAuth);\n  }\n\n  if (context.updatingAuth && context.updatingAuth.authProvidersUserPool) {\n    const { resourceName, authProvidersUserPool, hostedUIProviderMeta } = context.updatingAuth;\n    const { hostedUIProviderCreds } = context.amplify.loadEnvResourceParameters(context, 'auth', resourceName);\n    const oAuthCreds = parseOAuthCreds(authProvidersUserPool, hostedUIProviderMeta, hostedUIProviderCreds);\n    context.updatingAuth = Object.assign(context.updatingAuth, oAuthCreds);\n  }\n\n  if (context.updatingAuth && context.updatingAuth.authSelections === 'identityPoolOnly') {\n    coreAnswers.authSelections = 'identityPoolAndUserPool';\n  }\n};\n/* eslint-enable no-param-reassign */\n\n/*\n  Adding lambda triggers\n*/\nconst lambdaFlow = async (context: AuthContext, answers: any): Promise<any> => {\n  const triggers = await context.amplify.triggerFlow(context, 'cognito', 'auth', answers);\n  return triggers || answers;\n};\n\nexport const getIAMPolicies = (context: AuthContext, resourceName: any, crudOptions: any): any => {\n  let policy = {};\n  const actions: any[] = [];\n\n  crudOptions.forEach((crudOption: any) => {\n    switch (crudOption) {\n      case 'create':\n        actions.push(\n          'cognito-idp:ConfirmSignUp',\n          'cognito-idp:AdminCreateUser',\n          'cognito-idp:CreateUserImportJob',\n          'cognito-idp:AdminSetUserSettings',\n          'cognito-idp:AdminLinkProviderForUser',\n          'cognito-idp:CreateIdentityProvider',\n          'cognito-idp:AdminConfirmSignUp',\n          'cognito-idp:AdminDisableUser',\n          'cognito-idp:AdminRemoveUserFromGroup',\n          'cognito-idp:SetUserMFAPreference',\n          'cognito-idp:SetUICustomization',\n          'cognito-idp:SignUp',\n          'cognito-idp:VerifyUserAttribute',\n          'cognito-idp:SetRiskConfiguration',\n          'cognito-idp:StartUserImportJob',\n          'cognito-idp:AdminSetUserPassword',\n          'cognito-idp:AssociateSoftwareToken',\n          'cognito-idp:CreateResourceServer',\n          'cognito-idp:RespondToAuthChallenge',\n          'cognito-idp:CreateUserPoolClient',\n          'cognito-idp:AdminUserGlobalSignOut',\n          'cognito-idp:GlobalSignOut',\n          'cognito-idp:AddCustomAttributes',\n          'cognito-idp:CreateGroup',\n          'cognito-idp:CreateUserPool',\n          'cognito-idp:AdminForgetDevice',\n          'cognito-idp:AdminAddUserToGroup',\n          'cognito-idp:AdminRespondToAuthChallenge',\n          'cognito-idp:ForgetDevice',\n          'cognito-idp:CreateUserPoolDomain',\n          'cognito-idp:AdminEnableUser',\n          'cognito-idp:AdminUpdateDeviceStatus',\n          'cognito-idp:StopUserImportJob',\n          'cognito-idp:InitiateAuth',\n          'cognito-idp:AdminInitiateAuth',\n          'cognito-idp:AdminSetUserMFAPreference',\n          'cognito-idp:ConfirmForgotPassword',\n          'cognito-idp:SetUserSettings',\n          'cognito-idp:VerifySoftwareToken',\n          'cognito-idp:AdminDisableProviderForUser',\n          'cognito-idp:SetUserPoolMfaConfig',\n          'cognito-idp:ChangePassword',\n          'cognito-idp:ConfirmDevice',\n          'cognito-idp:AdminResetUserPassword',\n          'cognito-idp:ResendConfirmationCode',\n        );\n        break;\n      case 'update':\n        actions.push(\n          'cognito-idp:ForgotPassword',\n          'cognito-idp:UpdateAuthEventFeedback',\n          'cognito-idp:UpdateResourceServer',\n          'cognito-idp:UpdateUserPoolClient',\n          'cognito-idp:AdminUpdateUserAttributes',\n          'cognito-idp:UpdateUserAttributes',\n          'cognito-idp:UpdateUserPoolDomain',\n          'cognito-idp:UpdateIdentityProvider',\n          'cognito-idp:UpdateGroup',\n          'cognito-idp:AdminUpdateAuthEventFeedback',\n          'cognito-idp:UpdateDeviceStatus',\n          'cognito-idp:UpdateUserPool',\n        );\n        break;\n      case 'read':\n        actions.push(\n          'cognito-identity:Describe*',\n          'cognito-identity:Get*',\n          'cognito-identity:List*',\n          'cognito-idp:Describe*',\n          'cognito-idp:AdminGetDevice',\n          'cognito-idp:AdminGetUser',\n          'cognito-idp:AdminList*',\n          'cognito-idp:List*',\n          'cognito-sync:Describe*',\n          'cognito-sync:Get*',\n          'cognito-sync:List*',\n          'iam:ListOpenIdConnectProviders',\n          'iam:ListRoles',\n          'sns:ListPlatformApplications',\n        );\n        break;\n      case 'delete':\n        actions.push(\n          'cognito-idp:DeleteUserPoolDomain',\n          'cognito-idp:DeleteResourceServer',\n          'cognito-idp:DeleteGroup',\n          'cognito-idp:AdminDeleteUserAttributes',\n          'cognito-idp:DeleteUserPoolClient',\n          'cognito-idp:DeleteUserAttributes',\n          'cognito-idp:DeleteUserPool',\n          'cognito-idp:AdminDeleteUser',\n          'cognito-idp:DeleteIdentityProvider',\n          'cognito-idp:DeleteUser',\n        );\n        break;\n      default:\n        console.log(`${crudOption} not supported`);\n    }\n  });\n\n  let userPoolReference;\n\n  const { amplifyMeta } = context.amplify.getProjectDetails();\n\n  const authResource = _.get(amplifyMeta, [category, resourceName], undefined);\n\n  if (!authResource) {\n    throw new Error(`Cannot get resource: ${resourceName} from '${category}' category.`);\n  }\n\n  if (authResource.serviceType === 'imported') {\n    const userPoolId = _.get(authResource, ['output', 'UserPoolId'], undefined);\n\n    if (!userPoolId) {\n      throw new Error(`Cannot read the UserPoolId attribute value from the output section of resource: '${resourceName}'.`);\n    }\n\n    userPoolReference = userPoolId;\n  } else {\n    userPoolReference = {\n      Ref: `${category}${resourceName}UserPoolId`,\n    };\n  }\n\n  policy = {\n    Effect: 'Allow',\n    Action: actions,\n    Resource: [\n      {\n        'Fn::Join': ['', ['arn:aws:cognito-idp:', { Ref: 'AWS::Region' }, ':', { Ref: 'AWS::AccountId' }, ':userpool/', userPoolReference]],\n      },\n    ],\n  };\n\n  const attributes = ['UserPoolId'];\n\n  return { policy, attributes };\n};\n"]}