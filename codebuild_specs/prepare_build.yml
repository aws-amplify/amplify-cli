---
version: 0.2
phases:
  install:
    runtime-versions:
      nodejs: 14
    commands:
      - yarn config set script-shell $(which bash)
  pre_build:
    commands:
      - /bin/bash ./codebuild_specs/cache-load.sh
      - echo running prebuild
      - yarn config set cache-folder /root/.yarn-cache -g
      - yarn install --frozen-lockfile
  build:
    commands:
      - yarn production-build
  post_build:
    commands:
      - ls
      - ls ~/.cache
      - ls ~/.ssh
      - ls ~/.
      - ls ~
      - ls .
      - /bin/bash ./codebuild_specs/cache-store.sh
      - ls /root/myCache
cache:
  paths:
    - '/root/.yarn-cache/**/*'
    - 'node_modules/**/*'
    - 'packages/**/node_modules/**/*'
